<div class="list container top-container">
    <div class="foback-header">
      <app-button
        [text]="'Retour'"
        [type]="'tertiary'"
        [iconLeft]="'icon-go-back'"
      ></app-button>
      <div class="right-buttons">
        <app-button
          [text]="'Importer'"
          [type]="'tertiary'"
          [iconLeft]="'icon-file'"
          [customStyle]="{'white-space': 'nowrap'}"
        ></app-button>&nbsp;
        <app-button
          [text]="'Exporter'"
          [type]="'tertiary'"
          [iconLeft]="'icon-file'"
          [customStyle]="{'white-space': 'nowrap'}"
        ></app-button>
        &nbsp;
        <app-button
          [text]="'Ajouter un utilisateur/collaborateur'"
          [type]="'primary'"
          [iconLeft]="'fa fa-plus'"
          (onClick)="openSelectRole()"
          [customStyle]="{'white-space': 'nowrap'}"
        ></app-button>
      </div>
    </div>
    <div class="sub-header container-fuil container-lg">
      <h1 class="main-title">
        Collaborateurs
      </h1>

      <div class="search d-flex">
        <div class="input-group">
          <input type="text"
                 class="form-control input"
                 placeholder="Rechercher un collaborateur"
                 (input)="getUsers()"
                 aria-describedby="basic-addon2"
                 [(ngModel)]="filter.keyword"/>
          <div class="input-group-append" id="basic-addon2">
            <i class="fa fa-search"></i>
          </div>
        </div>&nbsp;
        <app-button
          [text]="'Recherche avancé'"
          [iconLeft]="'fa fa-filter'"
          [type]="'secondary'"
          (onClick)="showFilters = !showFilters; resetFillters()"
          [customStyle]="{'white-space': 'nowrap'}"
        ></app-button>
      </div>
    </div>
    <div class="filter-container" *ngIf="showFilters">
      <h3 class="filter-tilte-bloc ">
        <span>Recherche avancée</span>
        <span class="reset-filters">
          <i class="icon-close"></i>&nbsp;
          réinitialiser le filtres
        </span>
      </h3>
      <div class="filtres row ">
        <div class="flex-column col-4">
          <label>Manager</label>
          <div>
            <ng-select class="select"
                       [items]="managers"
                       [placeholder]="'Filtrer par manager'" ></ng-select>
          </div>
        </div>
        <div class=" flex-column col-4">
          <label>Etablissement Juridique</label>
          <div>
            <ng-select class="select"
                       [items]="etablissementJuridiques"
                       [placeholder]="'Filtrer par établissement Juridique'" ></ng-select>
          </div>
        </div>
        <div class=" flex-column col-4">
          <label>Direction opérationnelle</label>
          <div>
            <ng-select class="select"
                       [items]="directionOperationnelles"
                       [placeholder]="'Filtrer par direction opérationnelle'"></ng-select>
          </div>
        </div>
      </div>
      <div class="filtres row ">
        <div class=" flex-column col-4">
          <label>Business Unit</label>
          <div>
            <ng-select class="select"
                       [items]="directionOperationnelles"
                       [placeholder]="'Filtrer par business unit'"></ng-select>
          </div>
        </div>
        <div class=" flex-column col-4">
          <label>Département</label>
          <div>
            <ng-select class="select"
                       [items]="departements"
                       [placeholder]="'Filtrer par département'" ></ng-select>
          </div>
        </div>
        <div class=" flex-column col-4">
          <label>Centre de Profit</label>
          <div>
            <ng-select class="select"
                       [items]="centreProfits"
                       [placeholder]="'Filtrer par centre de Profit'" ></ng-select>
          </div>
        </div>
      </div>
      <div class="filtres row ">
        <div class=" flex-column col-4">
          <label>Catégorie</label>
          <div>
            <ng-select class="select"
                       [items]="categories"
                       [placeholder]="'Filtrer par catégorie'" ></ng-select>
          </div>
        </div>
        <div class=" flex-column col-4">
          <label>Etat</label>
          <div>
            <ng-select class="select"
                       [items]="etats"
                       [placeholder]="'Filtrer par état'" ></ng-select>
          </div>
        </div>
        <div class=" flex-column col-4">
        </div>
      </div>
    </div>
    <div class="sub-header" *ngIf="showFilters || keyword?.length>0">
      <h2 class="main-title">
        Résultats de recherche
      </h2>
    </div>
    <div class="wrap">
        <div class="table-wrapper">
            <table class="table-responsive card-list-table">
                <thead>
                    <tr>
                        <th colspan="2">
                          <i class="icon-username"></i>
                          Nom complet</th>
                        <th>
                          <i class="icon-email"></i>
                          Email</th>
                         <th>
                           <i class="icon-phone"></i>
                           Téléphone</th>
                        <th>
                          <i class="icon-manager"></i>
                          Manager</th>
<!--                        <th class="text-center">Date de création</th>-->
<!--                        <th>Dernière activité</th>-->
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let user of users"  [routerLink]="['/users/info/'+user.id]">
                        <td colspan="2">
                          <div class="photo-cell">
                            <div class="photo">
                              <div class="img-container">
                                <img
                                  [attr.src]="user?.photo_profil ? ('document/'+user.photo_profil_id+'/file' |
                      getPhotoFromBackend: ('assets/images/'+(user.civilite === 'Mme' ? 'woman.png': 'man.png')) |
                      async) : ('assets/images/'+(user.civilite === 'Mme' ? 'woman.png': 'man.png'))"
                                />

                              </div>
                            </div>
                            <div class="name">{{user?.nom}} {{user?.prenom}}</div>
                          </div>
                        </td>
<!--                        <td data-title="Nom"></td>-->
                        <td data-title="Email" >{{user?.email}}</td>
                         <td data-title="Téléphonne">{{user?.telephone}}</td>
                        <td data-title="Manager">{{user?.manager?.nom}}</td>

<!--                        <td data-title="Date de création" class="text-center">{{user?.created_at | defaultFormat }}</td>-->
<!--                        <td data-title="Dernière activité" class="lightcell">{{user?.last_activity | timeAgo }}</td>-->
                        <td >
<!--                            appStopPropagation-->
                            <div class="actions">
                                <i class="icon-edit"
                                   data-toggle="tooltip"
                                   data-placement="top"
                                   [routerLink]="['/users/update/'+user.id]"
                                   title="Détails"></i>
                              <span class="d-none d-lg-flex">Détails</span>

<!--                                <ng-container *ngIf="!user.blocked_at; else unlock">-->
<!--                                    <i class="fa fa-lock"-->
<!--                                       data-toggle="tooltip"-->
<!--                                       data-placement="top"-->
<!--                                       (click)="askBlockUser(user.id)"-->
<!--                                       title="{{'DISABLE ACCOUNT' | translate}}"></i>-->
<!--                                </ng-container>-->
<!--                                <ng-template #unlock>-->
<!--                                    <i class="fa fa-unlock"-->
<!--                                       data-toggle="tooltip"-->
<!--                                       data-placement="top"-->
<!--                                       (click)="askUnBlockUser(user.id)"-->
<!--                                       title="{{'ENABLE ACCOUNT' | translate}}"></i>-->
<!--                                </ng-template>-->
<!--                                <i class="fa fa-trash"-->
<!--                                   (click)="archive(user.id)"-->
<!--                                   data-toggle="tooltip"-->
<!--                                   data-placement="top"-->
<!--                                   title="{{'DELETE' | translate}}"></i>-->
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<ng-template  [ngxPermissionsOnly]="['superadmin']">
    <app-floating [addTitle]="'Ajouter un utilisateur'" (onAddClick)="gotoAddUser()"></app-floating>
</ng-template>
