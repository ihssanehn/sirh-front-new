<div class="list container top-container">
<!--    <div class="foback-header">-->
<!--&lt;!&ndash;      <app-button&ndash;&gt;-->
<!--&lt;!&ndash;        [text]="'Retour'"&ndash;&gt;-->
<!--&lt;!&ndash;        [type]="'tertiary'"&ndash;&gt;-->
<!--&lt;!&ndash;        [iconLeft]="'icon-go-back'"&ndash;&gt;-->
<!--&lt;!&ndash;      ></app-button>&ndash;&gt;-->
<!--      <div class="right-buttons">-->
<!--&lt;!&ndash;        <app-button&ndash;&gt;-->
<!--&lt;!&ndash;          [text]="'Importer'"&ndash;&gt;-->
<!--&lt;!&ndash;          [type]="'tertiary'"&ndash;&gt;-->
<!--&lt;!&ndash;          [iconLeft]="'icon-file'"&ndash;&gt;-->
<!--&lt;!&ndash;          [customStyle]="{'white-space': 'nowrap'}"&ndash;&gt;-->
<!--&lt;!&ndash;        ></app-button>&nbsp;&ndash;&gt;-->
<!--&lt;!&ndash;        <app-button&ndash;&gt;-->
<!--&lt;!&ndash;          [text]="'Exporter'"&ndash;&gt;-->
<!--&lt;!&ndash;          [type]="'tertiary'"&ndash;&gt;-->
<!--&lt;!&ndash;          [iconLeft]="'icon-file'"&ndash;&gt;-->
<!--&lt;!&ndash;          [customStyle]="{'white-space': 'nowrap'}"&ndash;&gt;-->
<!--&lt;!&ndash;        ></app-button>&ndash;&gt;-->
<!--        &nbsp;-->
<!--        <app-button-->
<!--          [text]="'Ajouter un utilisateur/collaborateur'"-->
<!--          [type]="'primary'"-->
<!--          [iconLeft]="'fa fa-plus'"-->
<!--          (onClick)="openSelectRole()"-->
<!--          [customStyle]="{'white-space': 'nowrap'}"-->
<!--        ></app-button>-->
<!--      </div>-->
<!--    </div>-->
    <div class="sub-header container-fuil container-lg row">
      <h1 class="main-title">
        Utilisateurs
      </h1>

      <div class="search d-flex">
        <div class="input-group">
          <input type="text"
                 class="form-control input"
                 placeholder="Rechercher un utilisateur"
                 (input)="getUsers()"
                 aria-describedby="basic-addon2"
                 [(ngModel)]="filter.keyword"/>
          <div class="input-group-append" id="basic-addon2">
            <i class="fa fa-search"></i>
          </div>
        </div>&nbsp;
        <app-button
          [text]="'Rechercher'"
          [type]="'secondary_2'"
          (onClick)="getUsers()"
          [customStyle]="{'white-space': 'nowrap'}"
        ></app-button>&nbsp;
        <app-button
          [text]="'Recherche avancé'"
          [iconRight]="showFilters ? 'icon-arrow-up': 'icon-arrow-down'"
          [type]="'tertiary'"
          (onClick)="showFilters = !showFilters; resetFilters()"
          [customStyle]="{'white-space': 'nowrap'}"
        ></app-button>
      </div>
      <div class="right-buttons">
        <app-button
          [text]="'Ajouter'"
          [type]="'secondary'"
          [iconRight]="'icon-add'"
          (onClick)="openSelectRole()"
          [customStyle]="{'white-space': 'nowrap'}"
        ></app-button>
      </div>
    </div>
  <div class="filter-container" *ngIf="showFilters">
    <h3 class="filter-tilte-bloc ">
      <span>Recherche avancée</span>
      <span class="reset-filters">
          <i class="icon-close"></i>&nbsp;
          réinitialiser le filtres
        </span>
    </h3>
    <div class="filtres row ">
      <div class="flex-column col-12 col-sm-6 col-lg-4  ">
        <label>Manager</label>
        <div>
          <ng-select class="select" [multiple]="true"  [multiple]="true"
                     [items]="managers"
                     (change)="filterChanged()"
                     [(ngModel)]="filter.managers"
                     [bindLabel]="'full_name'"
                     [bindValue]="'id'"
                     [placeholder]="'Filtrer par manager'" ></ng-select>
        </div>
      </div>
      <div class=" flex-column  col-12 col-sm-6 col-lg-4 ">
        <label>Contrat</label>
        <div>
          <ng-select class="select" [multiple]="true"
                     [items]="contracts"
                     [bindLabel]="'label'"
                     [bindValue]="'id'"
                     (change)="filterChanged()"
                     [(ngModel)]="filter.contracts"
                     [placeholder]="'Filtrer contrat'" ></ng-select>
        </div>
      </div>
      <div class=" flex-column  col-12 col-sm-6 col-lg-4 ">
        <label>Fonction</label>
        <div>
          <ng-select class="select" [multiple]="true"
                     [items]="functions"
                     [bindLabel]="'label'"
                     [bindValue]="'id'"
                     (change)="filterChanged()"
                     [(ngModel)]="filter.functions"
                     [placeholder]="'Filtrer par fonction'"></ng-select>
        </div>
      </div>
    </div>
    <div class="filtres row ">
      <div class="flex-column  col-12 col-sm-6 col-lg-4 ">
        <label>Profils</label>
        <div>
          <ng-select class="select" [multiple]="true"
                     [items]="profiles"
                     [bindLabel]="'label'"
                     [bindValue]="'id'"
                     (change)="filterChanged()"
                     [(ngModel)]="filter.profiles"
                     [placeholder]="'Filtrer par profils'"></ng-select>
        </div>
      </div>
      <div class="flex-column  col-12 col-sm-6 col-lg-4 ">
        <label>Status</label>
        <div>
          <ng-select class="select" [multiple]="true"
                     [items]="status"
                     [bindLabel]="'label'"
                     [bindValue]="'id'"
                     (change)="filterChanged()"
                     [(ngModel)]="filter.status"
                     [placeholder]="'Filtrer par statut'" ></ng-select>
        </div>
      </div>
      <div class="flex-column  col-12 col-sm-6 col-lg-4 ">
        <label>Centre de Profit</label>
        <div>
          <ng-select class="select" [multiple]="true"
                     [items]="profit_centers"
                     [bindLabel]="'label'"
                     [bindValue]="'id'"
                     (change)="filterChanged()"
                     [(ngModel)]="filter.profit_centers"
                     [placeholder]="'Filtrer par centre de Profit'" ></ng-select>
        </div>
      </div>
    </div>
    <div class="filtres row">
      <div class="form-group  col-12 col-sm-6 col-lg-4  block-check ">
        <label class="">Utilisateur virtuel</label>
        <div class="btn-group btn-group-toggle"
             ngbRadioGroup name="radioBasic"
             (change)="filterChanged()"
             [(ngModel)]="filter.is_virtual">
          <label ngbButtonLabel
                 [ngClass]="{'btn-primary': filter.is_virtual === true}">
            <input ngbButton type="radio" [value]="true"> Oui
          </label>
          <label ngbButtonLabel class="btn-primary"
                 [ngClass]="{'btn-primary': filter.is_virtual === null}">
            <input ngbButton type="radio" [value]="null"> Tous
          </label>
          <label ngbButtonLabel
                 [ngClass]="{'btn-primary': filter.is_virtual === false}">
            <input ngbButton type="radio" [value]="false"> Non
          </label>
        </div>
      </div>
    </div>
  </div>
    <div class="sub-header" *ngIf="showFilters || keyword?.length>0">
      <h2 class="main-title">
        Résultats de recherche
      </h2>
    </div>
    <div class="wrap" *ngIf="users?.length>0; else emptyState" >
        <div class="table-wrapper">
            <table class="table-responsive card-list-table">
                <thead>
                    <tr>
                        <th>
<!--                          <i class="icon-username"></i>-->
                          Nom
                        </th>
<!--                        <th>-->
<!--&lt;!&ndash;                          <i class="icon-username"></i>&ndash;&gt;-->
<!--                          Prénom-->
<!--                        </th>-->
                        <th>
<!--                          <i class="icon-email"></i>-->
                          N°
                        </th>
                         <th>
<!--                           <i class="icon-phone"></i>-->
                           Profil
                         </th>
                        <th>
<!--                          <i class="icon-manager"></i>-->
                          Centre de profit
                        </th>
                        <th>
<!--                            <i class="icon-manager"></i>-->
                          Email
                        </th>
                        <th>
  <!--                            <i class="icon-manager"></i>-->
                            Tel
                        </th>
<!--                        <th class="text-center">Date de création</th>-->
<!--                        <th>Dernière activité</th>-->
                        <th class="icon-cell"></th>
                    </tr>
                </thead>
                <tbody>
<!--                [routerLink]="['/users/info/'+user.id]"  (click)="openModal()"-->
                   <tr *ngFor="let user of users"  >
                        <td>
                          <div class="photo-cell">
                            <div class="photo">
                              <div class="img-container">
                                <img
                                  [attr.src]="user?.photo_profil ? ('document/'+user.photo_profil_id+'/file' |
                      getPhotoFromBackend: ('assets/images/'+(user?.civility === 'Mme' ? 'woman.png': 'man.png')) |
                      async) : ('assets/images/'+(user?.civility === 'Mme' ? 'woman.png': 'man.png'))"
                                />
                              </div>
                            </div>
                            <div class="name">{{user?.full_name}} </div>
                          </div>
                        </td>
                     <td>{{user?.registration_number}}</td>
                        <td data-title="Email" >{{user?.profile_name}}</td>
                         <td data-title="Téléphonne" class="tel">{{user?.cp_name}}</td>
                        <td data-title="Profil">{{user?.email_professional}}</td>
                        <td data-title="Centre d'interêt">{{user?.telephone_professional}}</td>

<!--                        <td data-title="Date de création" class="text-center">{{user?.created_at | defaultFormat }}</td>-->
<!--                        <td data-title="Dernière activité" class="lightcell">{{user?.last_activity | timeAgo }}</td>-->
                        <td class="icon-cell">
<!--                            appStopPropagation-->
                            <div class="actions">
                                <i class="icon-eye"
                                   data-toggle="tooltip"
                                   data-placement="top"
                                   (click)="openModal(user?.id)"
                                   title="Détails"></i>
<!--                              <span class="d-none d-lg-flex">Détails</span>-->

<!--                                <ng-container *ngIf="!user.blocked_at; else unlock">-->
<!--                                    <i class="fa fa-lock"-->
<!--                                       data-toggle="tooltip"-->
<!--                                       data-placement="top"-->
<!--                                       (click)="askBlockUser(user.id)"-->
<!--                                       title="{{'DISABLE ACCOUNT' | translate}}"></i>-->
<!--                                </ng-container>-->
<!--                                <ng-template #unlock>-->
<!--                                    <i class="fa fa-unlock"-->
<!--                                       data-toggle="tooltip"-->
<!--                                       data-placement="top"-->
<!--                                       (click)="askUnBlockUser(user.id)"-->
<!--                                       title="{{'ENABLE ACCOUNT' | translate}}"></i>-->
<!--                                </ng-template>-->
<!--                                <i class="fa fa-trash"-->
<!--                                   (click)="archive(user.id)"-->
<!--                                   data-toggle="tooltip"-->
<!--                                   data-placement="top"-->
<!--                                   title="{{'DELETE' | translate}}"></i>-->
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
<!--    <app-pagination name="pagination" (change)="changePagination()" [(ngModel)]="pagination" ngDefaultControl></app-pagination><br>-->
  <div class="footer" *ngIf="users?.length>0">

    <app-pagination name="pagination"
                    (change)="changePagination()"
                    [(ngModel)]="pagination"
                    ngDefaultControl>
    </app-pagination>
    <div class="right-buttons flex-end">
      <app-button
        [text]="'Importer'"
        [type]="'tertiary_inverse'"
        [iconLeft]="'icon-file'"
        [customStyle]="{'white-space': 'nowrap'}"
      ></app-button>&nbsp;
      <app-button
        [text]="'Exporter'"
        [type]="'tertiary_inverse'"
        [iconLeft]="'icon-file'"
        [customStyle]="{'white-space': 'nowrap'}"
      ></app-button>
    </div>
  </div>
</div>

<ng-template  [ngxPermissionsOnly]="['superadmin']">
    <app-floating [addTitle]="'Ajouter un utilisateur'" (onAddClick)="gotoAddUser()"></app-floating>
</ng-template>

<ng-template #emptyState>
  <app-centred-message
    [image]="'images/user_empty_state.svg'"
    [message]="( 'Aucun utilisateur trouvé pour le moment' | translate )"
  ></app-centred-message>
</ng-template>
